\documentclass{amsart}
\input{decls}
\usepackage{enumitem}
\title{Semantics of higher inductive types}
\author{Peter LeFanu Lumsdaine and Michael Shulman}
\setitemize[1]{leftmargin=2em}
\setenumerate[1]{leftmargin=*}
\autodefs{\cAlg\nId\cCat\bSet\ncolim}
\mdef\ivl{\mathbf{I}\xspace}
\begin{document}
\maketitle

In this note we will explain a certain type of categorical semantics for a certain class of higher inductive types.
Specifically, we will consider higher inductive types which have only 0-constructors and 1-constructors, and for which the domains and codomains of the 1-constructors are strictly natural.
The former restriction is merely for convenience; there seems no obstacle to generalizing the methods presented herein to higher constructors.
The latter is more basic, although a generalization to ``coherently natural'' transformations might perhaps be possible.

We will define what it means to have semantics for such a higher inductive definition in any category with ``strictly Reedy-functorial path objects''.
This assumption simplifies the definitions, and additionally gives a natural way to make sense out of judgmental computation rules for 1-constructors as well as 0-constructors.
However, it should not be necessary.

Finally, we will also show that such semantics do exist in a reasonably wide class of model categories.
Cisinski and Gepner--Kock have shown that any $(\infty,1)$-topos can be presented by some model category in this class, while Lumsdaine--Warren have shown that any model category in this class admits a strictly coherent model of type theory.
Thus, higher inductive types exist in the internal type theory of any $(\infty,1)$-topos.

\section{An explicit simple case}
\label{sec:simplified-example}

The general construction involves a lot of category-theoretic technology, so in this introductory section we explain a very simple case more explicitly.
Consider the ``standard'' set-theoretic model.
This is not homotopical, but higher inductive types (at least with 0- and 1-constructors) are still interesting and---surprisingly---nontrivial.
Not only do they include quotient types, but they also include free algebras for arbitrary (infinitary) algebraic theories, which are known to be impossible to construct in ZF.
Higher inductive sets allow us to define a set inductively and quotient it by an equivalence relation at the same time.

Concretely, the basic idea is to define not just the higher inductive set $W$ generated by some list of constructors, but to define, for any set $X$, the higher inductive set $W_X$ generated by those constructors together with an additional constructor $X \to W_X$.
Categorically, this means that rather than merely constructing an initial object in some category of algebras, we will construct a left adjoint to the forgetful functor from the category of algebras to \bSet---or equivalently, a monad on \bSet inducing the given category of algebras.
The initial algebra we are interested in is the image of the initial set $\emptyset$ under this left adjoint; the rest of the monad makes possible an inductive argument over the list of constructors.

A little more precisely,
in this section we will sketch a proof of the following informally stated theorem.

\begin{thm}\label{thm:simple}
  For any suitable list of 0-constructors and 1-constructors defining a higher inductive type $W$, there is a monad $T$ on \bSet such that:
  \begin{itemize}
  \item For any $Y$, the data required by the eliminator to specify a function $W_X \to Y$, where $W_X$ is the higher inductive type generated by the given constructors together with $X\to W_X$, is precisely a $T$-algebra structure on $Y$ together with a function $X\to Y$.
  \end{itemize}
  Therefore, we can take $W_X$ to be $T X$, and in particular $W$ to be $T\emptyset$.
\end{thm}

We should think of the elements of $TX$ as some sort of ``trees'' or ``formal expressions'', whose nodes or generators come from $X$, whose branching type is specified by the 0-constructors, but which are quotiented by some equivalence relation generated by the 1-constructors.

We will prove \autoref{thm:simple} by induction on the number of constructors.
If there are no constructors, then we can take $T$ to be the identity monad.
Thus, assume that the monad $T_n$ exists, with unit $\eta_X:X\to T_n X$ and multiplication $\mu_X:T_n^2 X \to T_n X$; we will construct $T_{n+1}$.

Suppose first that the $(n+1)^{\mathrm{st}}$ constructor is a 0-constructor, whose arguments are specified by an endofunctor $F:\bSet\to\bSet$.
Generally $F$ is some sort of polynomial functor, or a finite product of such, but on the semantic side all we need of it is that it is \emph{accessible}, meaning that it preserves colimits of sufficiently long transfinite sequences
\[ X_0 \to X_1 \to X_2 \to \cdots \to X_\omega \to X_{\omega+1} \to \cdots. \]
In fact, for simplicity let us assume that it preserves colimits of \emph{countable} sequences.
We will also suppose that $T_n$ has the same property (this will follow inductively by the construction).

Now adding an extra 0-constructor means that the input data to the eliminator at $Y$ is augmented by a function $FY\to Y$.
Thus, in order for $T_{n+1}$ to have the desired property, to give a $T_{n+1}$-algebra structure on $Y$ must be equivalent to giving a $T_n$-algebra structure together with a function $F Y \to Y$.
This is equivalent to saying that $T_{n+1} X$ must be the free object generated by $X$ in the category of $T_n$-algebras $Y$ equipped with functions $F Y \to Y$.

We will define by induction a diagram as follows:
\begin{equation}
  \vcenter{\xymatrix{
       &
       T_n X_0\ar[r]^{T x_0}\ar[d]^{t_0} &
       T_n X_1\ar[r]^{T x_1}\ar[d]^{t_1} &
       T_n X_2\ar[r]^{T x_2}\ar[d]^{t_2} &
       \cdots \\
       X_0\ar[r]^{x_0} &
       X_1\ar[r]^{x_1} &
       X_2\ar[r]^{x_2} &
       X_3\ar[r]^{x_3} &
       \cdots \\
       & F X_0\ar[r]_{F x_0}\ar[u]_{f_0} &
       F X_1\ar[r]_{F x_1}\ar[u]_{f_1} &
       F X_2\ar[r]_{F x_2}\ar[u]_{f_2} &
       \cdots
      }}
\end{equation}
such that $t_i \circ \eta_{X_i}= x_i$ for each $i$.
(In fact, we will use this as a definition of $x_i$.)
Let $X_0=X$, and let $X_1 = T_n X + F X$, with $t_0$ and $f_0$ the inclusions.
At each subsequent stage, we let $X_{i+2}$ be the coequalizer of the two composites
\begin{equation}
  \vcenter{\xymatrix{
      & T_n X_i \ar[dr]^{T_n \eta}\\
      T_n^2 X_i \ar@{=}[rr]\ar[ur]^{\mu} &&
      T_n^2 X_i \ar[r]_-{T_n t_i } &
      T_n X_{i+1}\ar[r] &
      (T_n X_{i+1}+ F X_{i+1})
    }}
\end{equation}
with $t_{i+1}$ and $f_{i+1}$ being the components of the quotient map.

Let $T_{n+1} X \coloneqq X_\infty = \ncolim (X_i)$ be the colimit of the sequence of $x_i$'s.
Since $F$ and $T_n$ preserve these sequential colimits, we have an induced map
\[F(X_\infty) = F(\ncolim(X_i)) \cong \ncolim (F X_i) \too \ncolim (X_i) = X_\infty\]
and likewise $T_n (X_\infty) \to X_\infty$.
By construction, we can show that this morphism $T_n (X_\infty) \to X_\infty$ makes $X_\infty$ into a $T_n$-algebra, and verify that it is freely generated by $X$.

Intuitively, what is happening is this.
Starting from $X=X_0$, we first generate all equivalence classes of trees on $X$ specified by the first $n$ constructors (this is $T_n X$), as well as all 1-stage trees on $X$ with a single branching node specified by the $(n+1)^{\mathrm{st}}$ constructor (this is $F X$).
Together these form $X_1$.

Next, we do the same thing to $X_1$ instead of $X$.
This gets us $T_n$-trees that can contain subnodes labeled by $F$, and similarly $F$-trees that can contain subnodes labeled by $F$ or by $T_n$-trees.
However, it also gives us $T_n$-trees containing subnodes labeled by $T_n$-trees, which duplicate some of the trees we already had in $X_1$.
The coequalizer gets rid of these by forcing them to be equal to the result of ``removing the parentheses''.

Finally, we repeat this over and over, gradually allowing deeper and deeper nestings of $F$-labeled trees inside of our $T_n$-labeled trees, until in the limit the sequence converges.

As the simplest possible example, note that when $n=0$, so that $T_0$ is the identity monad, then the coequalizer does nothing, so that we have simply
\begin{align}
  X_0 &= X\\
  X_1 &= X + F(X_0)\\
  X_2 &= X + F(X_1)\\
  X_3 &= X + F(X_2)\\
  &\vdots
\end{align}
which is the usual transfinite construction of the free monad on an endofunctor, i.e.\ the set of $F$-labeled trees.

Now suppose instead that the $(n+1)^{\mathrm{st}}$ constructor is a 1-constructor.
In this case, we again have an (accessible) endofunctor $F:\bSet\to\bSet$, but also two natural transformations $u,v:F \to T_n$, representing the domain and codomain of the equality (or path) we are intending to glue in.
Syntactically, this makes sense, since each of $u$ and $v$ is an expression involving the arguments to this constructor (hence their domain is $F$) and possibly the previous constructors (which exist as operations on any set of the form $T_n X$).

In this case, the additional input data required for the eliminator at $Y$ is the information that the composites $F Y \toto T_n Y \to Y$ are equal.
Thus, in order for $T_{n+1}$ to be as desired, to give a $T_{n+1}$-algebra structure on $Y$ must be equivalent to giving a $T_n$-algebra structure with this property.
Hence, $T_{n+1} X$ must be the free object generated by $X$ in the category of $T_n$-algebras with this property.

We now perform a closely analogous construction.
We define a sequence
\begin{equation}
  \vcenter{\xymatrix{
       &
       T_n X_0\ar[r]^{T x_0}\ar[d]^{t_0} &
       T_n X_1\ar[r]^{T x_1}\ar[d]^{t_1} &
       T_n X_2\ar[r]^{T x_2}\ar[d]^{t_2} &
       \cdots \\
       X_0\ar[r]^{x_0} &
       X_1\ar[r]^{x_1} &
       X_2\ar[r]^{x_2} &
       X_3\ar[r]^{x_3} &
       \cdots
      }}
\end{equation}
such that $t_i \circ \eta_{X_i}= x_i$ for each $i$, and moreover $t_i \circ u_{X_i} = t_i \circ v_{X_i}$.
We let $X_0=X$, and let $X_1$ be the coequalizer of $u_X,v_X: F X \toto T_n X$, with $t_0$ the quotient map.
At each subsequent stage, we let $X_{i+2}$ be the colimit of the diagram
\begin{equation}
  \vcenter{\xymatrix{
      & T_n X_i \ar[dr]^{T_n \eta} &&
      F X_{i+1} \ar@<1mm>[d]^u \ar@<-1mm>[d]_v \\
      T_n^2 X_i \ar@{=}[rr]\ar[ur]^{\mu} &&
      T_n^2 X_i \ar[r]^-{T_n t_i } &
      T_n X_{i+1}
    }}
\end{equation}
with $t_{i+1}$ the obvious induced map.
We let $T_{n+1} X \coloneqq X_\infty = \ncolim (X_i)$ as before, and show that this has the right universal property.

Intuitively, what is happening in this case is that starting from $X$, we generate all the $T_n$-labeled trees, then impose the equivalence relation specified by $F$, $u$, and $v$.
This gives us $X_1$, the coequalizer of $u,v:FX \toto T_n X$.

However, it is no longer obvious that the quotient is a $T_n$-algebra.
Thus, we have to once again freely generate the $T_n$-labeled trees on $X_1$, impose the equivalence relation specified by $F$, $u$, and $v$, and also force the new $T_n$-algebra structure to agree with what we did have coming from $X_1$.
Then we repeat this until it converges.

% It seems like if $T_n$ is itself a free monad on an endofunctor (i.e. there are no 1-constructors among the first n), then perhaps we should be able to stop after one step by invoking the axiom of choice to split $t_0$.  But I'm not entirely sure, and I don't think it can work in any more generality than that.

We now present in more detail a construction which generalizes the above sketch in the following ways.
\begin{itemize}
\item It works in a general homotopical context, rather than \bSet, thereby producing models of higher inductive types in \emph{intensional} type theory.
\item In particular, this necessitates ensuring that all objects are fibrant and that enough maps are fibrations.
\item It allows parameters and indices in the higher inductive definitions.
\item It allows the \emph{arguments} of each constructor to depend on previous constructors in some way.
  It is not clear whether this is useful, or whether there is a good way to represent the appropriate type of dependency syntactically.
\end{itemize}


\section{A reminder about indexed categories}
\label{sec:indexed}

Recall that a \emph{\sC-indexed category} is a pseudofunctor $\sD:\sC\op\to\cCat$.
Thus it consists of for each $\Gamma\in\sC$, a category $\sD^\Gamma$, and restriction or ``pullback'' functors $f^*:\sD^{\Gm}\to\sD^{\Gm'}$.
The canonical example is $\sD^\Gm = \sC/\Gm$, if \sC has pullbacks.
We will generally abuse notation by denoting this \sC-indexed category also by \sC.

More generally, for any $\Delta\in\sC$ we have a \sC-indexed category ``$\sC/\Delta$'', defined by $(\sC/\Delta)^\Gm = \sC/(\Delta\times\Gm)$.
Similarly, if $\Delta \in\sC/\Gamma$, we have a $(\sC/\Gamma)$-indexed category ``$\sC/\Delta$'' defined by $(\sC/\Delta)^{f:\Gm'\to\Gm} = \sC/f^*\Delta$.

A \emph{\sC-indexed functor} is a pseudonatural transformation, consisting of functors $F^\Gm:\sD^\Gm \to \sE^\Gm$ commuting up to specified isomorphism with pullback.
And a \emph{\sC-indexed natural transformation} is a modification, consisting of compatible natural transformations $F^\Gm \to G^\Gm$.

We say that a \sC-indexed category \sD is \emph{fiberwise cocomplete} if each category $\sD^\Gm$ is cocomplete and each functor $f^*$ preserves colimits.
Similarly, it is \emph{fiberwise locally presentable} if each $\sD^\Gm$ is locally presentable.


\section{A reminder about free constructions}
\label{sec:free}

If $T$ is an endofunctor of a category \sC, then an \textbf{algebraically-free monad} on $T$ is a monad $P$ whose category of monad-algebras is equivalent, over \sC, to the category of endofunctor-algebras for $T$.
It follows that $P$ is also the free monad on $T$, in the sense of a left adjoint from the category of monads to the category of endofunctors.
When \sC is locally presentable and $T$ is accessible, then the algebraically-free monad always exists; it can be constructed by a certain transfinite colimit (see \S\ref{sec:simplified-example}).

Similarly, if $\{T_i\}$ is a small diagram in the category of monads on \sC, then an \textbf{algebraic colimit} of it is a monad $P$ whose category of monad-algebras is equivalent, over \sC, to the category of objects equipped with compatible algebra structures for each $T_i$.
It follows that $P$ is also a colimit of $\{T_i\}$ in the category of monads.
When \sC is locally presentable and each $T_i$ is accessible, then the algebraic colimit always exists, and can also be obtained as a transfinite colimit.

We will invoke these general facts in order to avoid having to give explicit transfinite constructions as we did in \S\ref{sec:simplified-example}.


\section{What we need from a category}
\label{sec:categorical-setup}

Let \sC be a category equipped with a class of maps called \emph{fibrations} closed under pullback.
We denote a fibration by $A \fib \Gamma$.
We assume that \sC satisfies the requisite hypotheses so that we can apply some coherence theorem to it and obtain a model of dependent type theory in which dependent types are represented by the fibrations.

The primary other thing we need from \sC is a good weak factorization system, in order to model identity types.
We say that a morphism is an \emph{acyclic cofibration} if it has the left lifting property with respect to all fibrations.
We require that
\begin{itemize}
\item Every morphism of \sC factors as an acyclic cofibration followed by a fibration.
\item The pullback of an acyclic cofibration along a fibration is an acyclic cofibration.
\item The pullback of an acyclic cofibration between fibrations along any morphism into the base of the fibrations is an acyclic cofibration.
\end{itemize}
These assumptions are satisfied in any right proper model category whose cofibrations are the monomorphisms, such as simplicial sets.

The identity type of a dependent type $A\fib \Gamma$ is then given by factoring the diagonal $A\to A\times_\Gamma A$ as an acyclic cofibration followed by a path object fibration $P_\Gamma A \fib A\times_\Gamma A$.
The actual such factorization depends on the details of how the coherence theorem is implemented.
Typically it is obtained by performing a factorization once in a universal case and then pulling back, so as to obtain strict preservation under substitution.

We will assume furthermore that our path objects are chosen \emph{functorially}.
By this we mean that there is a \sC-indexed functor $P:\sC\to\sC$ which sends $A\in\sC/\Gamma$ to $P_\Gamma A$, as above, and indexed natural transformations $\nId_\sC \to P \toto \nId_\sC$ factoring the diagonal such that if $A\fib\Gamma$ is a fibration, the induced factorization $A \to P_\Gamma A \to A\times_\Gamma A$ consists of an acyclic cofibration and a fibration.

This implies that in the internal type theory of \sC, there is a term \textsf{map} giving a judgmentally functorial action on identity types.
(Because $P$ is an \emph{indexed} functor, \textsf{map} is stable under pullback, and thus visible to the internal type theory.)
Since \textsf{map} preserves reflexivity judgmentally (this is the naturality of $\nId_\sC \to P$), it is propositionally equal to any such ``\textsf{map}'' term defined using the eliminator \textsf{J}, but there seems no reason for it to be judgmentally equal to any of them.

We will also assume that for any fibration $B\fib A$ over \Gm, the induced map to the pullback
\begin{equation}
  \vcenter{\xymatrix{
      P_\Gm B \ar@{.>}[dr] \ar@(r,ul)[drr] \ar@(d,ul)[ddr]\\
      &\bullet\pullbackcorner \ar[r]\ar[d] &
      B\times_\Gm B\ar[d]\\
      &P_\Gm A\ar[r] &
      A\times_\Gm A
      }}
\end{equation}
is a fibration.
In other words, ``$P$ takes fibrations to Reedy fibrations.''
In particular, this implies that $P$ preserves fibrations, i.e.\ the map $P_\Gm B \to P_\Gm A$ is a fibration.

The stronger condition means that we may use $P_\Gamma B$ to model ``dependent identity types'':
\begin{equation}\label{eq:depeq}
  (x,y:A), (p:x=y), (z:B(x)), (w:B(y)) \;\vdash\; (z =_p^B y) \;\mathsf{type}
\end{equation}
Since $B \to P_\Gamma B$ is still an acyclic cofibration, these dependent identity types satisfy the rules for an inductively defined family:
\begin{verbatim}
Inductive dep_eq {A} {B:A->Type} :
    forall (x y:A), (x=y) -> B x -> B y -> Type :=
| dep_refl : forall (x:A) (z:B a), dep_eq x x (refl x) z z.
\end{verbatim}
This is provably equivalent to the more usual type $\mathsf{trans}_p z = w$, but there seems no reason for them to be identical.

Moreover, the functoriality of $P$ on sections of fibrations gives a specified term \textsf{apd} in the type theory, valued in the dependent identity types.
Again, since this \textsf{apd} preserves reflexivity, it is propositionally equal to any ``\textsf{apd}'' defined using \textsf{J}, but there seems no reason for it to be judgmentally the same.

Neither of these extra assumptions on path objects is strictly necessary to define what it \emph{means} to have higher inductive types.
In their absence, rather than defining categories of algebras $\cAlg_I$ as we will do in \S\ref{sec:hits}, we must define separately instead what it means to be an algebra, an algebra fibration, and an algebra section of an algebra fibration.
We should probably do this eventually, in order to make completely precise the sense in which our ``semantics'' are the semantics of some syntax in type theory, since the syntactic categories of type theory will generally not satisfy these additional assumptions.
But we leave that to the future.

Moreover, in order to \emph{construct} higher inductive types in \S\ref{sec:constructing}, we will need these extra assumptions, which do in fact hold in our examples.
In fact, they hold in any simplicial model category, where $P_\Gamma A$ is the simplicial path object of $A$ in $\sC/\Gamma$, defined as the pullback:
\begin{equation}
  \vcenter{\xymatrix{
      P_\Gamma A\ar[r]\ar[d] &
      A^{\ivl}\ar[d]\\
      \Gamma\ar[r] &
      \Gamma^{\ivl}.
      }}
\end{equation}
where \ivl denotes the simplicial interval (the 1-simplex) and $X^\ivl$ the cotensor.
That this gives a path object was observed by Warren, and it is obviously functorial.
The Reedy-fibration property follows from the fact that $\sC/\Gamma$ is a simplicial model category (also proven by Warren), together with the facts that $B\fib A$ is a fibration and the inclusion of the endpoints into \ivl is a cofibration of simplicial sets.

By a \emph{homotopy} between morphisms $f,g:A\to B$ over $\Gamma$ we will mean a lifting of $(f,g):A\to B\times_\Gamma B$ to $P_\Gamma B$.
Functoriality of path objects means that if we have such a homotopy $H$ and a morphism $k:B\to C$, then we have a composite homotopy $(Pk)H$ between $kf$ and $kg$, and moreover $(P\ell)(Pk)H = (P(\ell k))H$.
A homotopy is \emph{constant} if it factors through $B\to P_\Gamma B$; such a factorization must be unique since $B\to P_\Gamma B$ is split monic.


\section{Higher inductive types}
\label{sec:hits}

A higher inductive definition is specified by a list of constructors, which (for the purposes of this note) may be either 0-constructors or 1-constructors.
We will not get into the details of syntax here; instead we will merely say what any syntax must supply semantically in order for the semantics to work.

Let $\Gamma$ be a fibrant object of \sC representing the parameters, and let $\Delta\fib\Gamma$ be a fibration, representing the indices.
The semantics of a higher inductive definition $I$ with parameters $\Gamma$ and indices \Delta will be determined by a $(\sC/\Gamma)$-indexed category $\cAlg_I$, whose objects we call \emph{$I$-algebras}, equipped with an indexed functor $U_I:\cAlg_I \to \sC/\Delta$.

Knowing this, we can define inductively what we require of the syntax.
If $I_n$ denotes the higher inductive definition specified by the first $n$ constructors, then:
\begin{enumerate}
\item If the $(n+1)^{\mathrm{st}}$ constructor is a 0-constructor, the syntax must yield a fibration $\Theta\fib \Gamma$, a $(\sC/\Gamma)$-indexed functor $F:\cAlg_{n} \to \sC/\Theta$, and a morphism $s:\Theta \to \Delta$ over $\Gamma$.
  Usually, $F$ is a dependent polynomial that knows nothing about $I_n$, i.e.\ of the form
  \begin{equation}\label{eq:deppoly}
    \vcenter{\xymatrix{
        \cAlg_{n} \ar[r]^{U_{n}} &
        \sC/\Delta\ar[r]^{p^*} &
        \sC/\Psi\ar[r]^{q_*} &
        \sC/\Theta
      }}
  \end{equation}
  for some diagram
  \begin{equation}
    \vcenter{\xymatrix{
      \Delta\ar@{<-}[r]^p &
      \Psi\ar@{->>}[r]^q &
      \Theta.
      }}
  \end{equation}
  in $\sC/\Gamma$.
  It might also be a finite product of such functors.
  However, allowing the domain of $F$ to be $\cAlg_n$ in theory may allow the arguments of one constructor to refer to the previous constructors.
\item If the $(n+1)^{\mathrm{st}}$ constructor is a 1-constructor, the syntax must yield $\Theta$ and $F$ as above, but also two morphisms $s,t:\Theta\to\Delta$ over $\Gamma$, a homotopy $H:s\sim t$, and two $(\sC/\Gamma)$-indexed natural transformations $u:s_! F\to U_{n}$ and $v:t_! F \to U_{n}$, with components
  \begin{equation}
    \vcenter{\xymatrix{
        F X\ar@<1mm>[r]^{u_X} \ar@<-1mm>[r]_{v_X} \ar[d] &
        X\ar[d]\\
        \Theta \ar@<1mm>[r]^{s} \ar@<-1mm>[r]_t &
        \Delta.
      }}
  \end{equation}
  The naturality of $u,v$ is the stickiest point in practice.
  It is difficult to ensure syntactically, and moreover a number of examples that we would like to include are merely ``coherently'' natural rather than strictly so.
  For now, however, we restrict to the strictly natural case, which still includes a large number of useful examples.
\end{enumerate}

We can now define each $\cAlg_{{n}}$, beginning the induction with $\cAlg_{0} = \sC/\Delta$.
If $\cAlg_{{n}}$ is given, along with a 0-constructor as above, then an $I_{n+1}$-algebra consists of an $I_n$-algebra $X$ together with a morphism $c:FX \to X$ over $s$, i.e.\ such that the following square commutes:
\begin{equation}\label{eq:0constr-alg}
  \vcenter{\xymatrix{
      F X\ar[r]^{c} \ar[d] &
      X\ar[d]\\
      \Theta\ar[r]_s &
      \Delta.
    }}
\end{equation}
An $I_{n+1}$-algebra morphism is, of course, an $I_n$-algebra morphism which commutes with the $c$'s.

On the other hand, if we have a 1-constructor as above, then an $I_{n+1}$-algebra consists of an $I_n$-algebra together with a homotopy $d:u_X \sim v_X$ over $\Gamma$ (that is, a map $FX \to P_\Gamma X$), which also lies over $H:s\sim t$ in the obvious sense (using functoriality of path objects).
An $I_{n+1}$-algebra morphism is an $I_n$-algebra morphism which commutes with the $d$'s (using again the functoriality of path objects).

Both definitions extend to $(\sC/\Gamma)$-indexed categories in an obvious way, since all the assumed structure is indexed.
Indeed, until further notice, all categories, functors, and transformations we consider will be $(\sC/\Gamma)$-indexed whether we mention it or not.

\begin{defn}\label{def:hit}
  A \textbf{higher inductive type} specified by a signature $I$ as above consists of
  \begin{enumerate}
  \item a fibration $W\fib \Delta$,
  \item which is an $I$-algebra, such that
  \item for any morphism $f:\Phi\to\Gamma$ with $\Phi$ fibrant, any $I$-algebra fibration $B\fib f^* W$ has an $I$-algebra section.\label{item:hit3}
  \end{enumerate}
\end{defn}

It should hopefully be evident in what sense asking for $W$ to be an $I$-algebra gives it the desired constructors.
Regarding the eliminator, the structure required on $B\fib W$ relating to the 0-constructors is as usual, whereas for a 1-constructor it amounts to giving an inhabitant of the dependent identity type~\eqref{eq:depeq} over the 1-constructor path in $W$.

Asking that the eliminator give an $I$-algebra section gives a judgmental computation rule for the 0-constructors, as usual, while for the 1-constructors it also gives a judgmental computation rule, using the specified dependent identity types and the specified term \textsf{apd}.

Finally, the ``weak stability'' of this universal property under pullback along maps of parameters $f:\Phi\to\Gamma$ is necessary for substitution in type theory to hold.
The coherence theorems (Voevodsky, Lumsdaine--Warren) ensure that the eliminator can then be made \emph{strictly} functorial under substitution.

The way that this works is as follows.
Suppose $\Util\fib U$ is a specified fibration which we regard as a ``universe of types''.
It might be a global universe or a local universe.
We say that a fibration is \emph{$U$-small} if it is a pullback of $\Util\fib U$ along some unspecified map.
By a \emph{$U$-named fibration} over $X$ we mean simply a map $X\to U$, regarded as naming the corresponding pullback of \Util.
Thus, $U$-named fibrations form a set and are strictly functorial.

\begin{lem}\label{thm:univfib}
  Suppose that each functor $F$ appearing in the definition of $I$ preserves fibrations.
  Then the functor
  \begin{align}
    (\sC/\Gamma)\op &\too \bSet\\
    (f:\Phi\to\Gamma) &\mapsto \{ \text{$U$-named $I$-algebra fibrations over $f^*W$} \}
  \end{align}
  is representable, and the representing object is a fibration $g_n:\Gamma^n \fib\Gamma$.
\end{lem}
Note that the assumption holds for dependent polynomial functors~\eqref{eq:deppoly}.
\begin{proof}
  We define $\Gamma^n$ by induction on $n$.
  Let $\Gamma^0$ be the dependent product of $W\times U$ along the composite fibration
  \[W \fib \Delta\fib \Gamma.\]
  This is a fibration since dependent product along fibrations preserves fibrations.
  A morphism $\Phi\to\Gamma^0$ is then equivalent to a morphism $f:\Phi\to\Gamma$ together with a $U$-named fibration over $f^*W$, as desired.

  Now suppose $g_n:\Gamma^n \fib\Gamma$ is defined and represents $U$-named $I_n$-algebra fibrations over $W$, with a universal such fibration $B_n \fib g_n^*W$.
  If the $(n+1)^{\mathrm{st}}$ constructor is a 0-constructor, specified by $\Theta$, $F$, and $s$ as above, then since $g_n^*W$ is an $I_{n+1}$-algebra, we have a morphism $c_{n+1}:F g_n^* W \to g_n^*W$.
  Moreover, since $F$ preserves fibrations, we have a fibration $F B_n \fib F g_n^*W$.
  Now pull $(c_{n+1})^* B_n$ back along the fibration $F B_n \fib F g_n^* W$, and then take the dependent product along the composite fibration
  \begin{equation}
    F B_n \fib F g_n^* W \fib g_n^*\Theta \fib \Gamma^n.\label{eq:ffib}
  \end{equation}
  Call the result $\Gamma^{n+1}$.
  Since local exponentials and dependent products preserve fibrations, we have a fibration $\Gamma^{n+1}\fib\Gamma^n$, and it is straightforward to check that $\Gamma^{n+1}$ has the right universal property.

  Next, suppose the $(n+1)^{\mathrm{st}}$ constructor is a 1-constructor, specified by data as above.
  Since $g_n^*W$ is an $I_{n+1}$-algebra, we have a homotopy $d_{n+1}:F g_n^*W \to P_{\Gamma^n} (g_n^*W)$ between $u_{g_n^*W}$ and $v_{g_n^*W}$.
  Let $Q$ be the pullback
  \begin{equation}
  \vcenter{\xymatrix{
      Q\ar[r]\ar[d] \pullbackcorner &
      B_n \times_{\Gamma^n} B_n\ar[d]\\
      P_{\Gamma^n} (g_n^* W)\ar[r] &
      g_n^* W \times_{\Gamma^n} g_n^* W.
      }}
  \end{equation}
  Then $d_{n+1}$ together with $u_{B_n}$ and $v_{B_n}$ induce a map $d':F B_n \to Q$.
  By the assumption that path objects take fibrations to Reedy fibrations, we have a fibration $P_{\Gamma^n} B_n \fib Q$.
  Now pull $P_{\Gamma^n} B_n$ back to $F B_n$ along $d'$, and then take the dependent product along~\eqref{eq:ffib}.
  We again obtain a fibration $\Gamma^{n+1}\fib\Gamma^n$, which has the correct universal property.
\end{proof}

We then obtain coherence for the eliminator as follows.
By the preceeding lemma, we have a universal $U$-named $I$-algebra fibration $B \fib g^*W$.
By \autoref{def:hit}\ref{item:hit3} applied to $g$, this has an $I$-algebra section.
Therefore, by pullback we obtain a section of any $U$-named $I$-algebra fibration $B\fib f^*W$, which is strictly functorial.

\begin{cor}\label{thm:hit3fib}
  If each functor $F$ preserves fibrations, then it suffices to assume \autoref{def:hit}\ref{item:hit3} when $f$ is a fibration.
\end{cor}
\begin{proof}
  By the above argument, it suffices to perform the eliminator when $f$ is the universal map $g_n:\Gamma^n \fib\Gamma$ defined for some $U$ (in a global universe model) or class of $U$'s (in a local one).
  (If we only wanted to derive \ref{item:hit3} as stated, it would suffice to take $\Util\fib U$ to be $B\fib f^*W$ itself.)
  But by \autoref{thm:univfib}, any such $g_n$ is a fibration.
\end{proof}


\section{Constructing HITs}
\label{sec:constructing}

Having defined what it means for higher inductive types to exist, we now describe one class of models in which we can construct them.
We suppose that \sC is a locally presentable, locally cartesian closed, right proper, cofibrantly generated, simplicial model category whose cofibrations are the monomorphisms.
For instance, simplicial sets are such a model category.
More generally, Cisinski and Gepner--Kock have shown that any $(\infty,1)$-topos can be presented by a model category of this sort.

We define path objects $P_\Gamma A$ using cotensors with $\ivl$, as in \S\ref{sec:categorical-setup}.
Note that cotensoring with $\ivl$ has a left adjoint given by tensoring with $\ivl$, so that a homotopy between morphisms $f,g:A\to B$ can equally be regarded as a morphism $A\otimes \ivl \to B$.

Local cartesian closure implies that pullbacks preserve colimits, so that \sC is fiberwise cocomplete regarded as a \sC-indexed category, and likewise for all of its slices.

Suppose further that each indexed functor $F$ is \emph{indexed-accessible}.
By this we mean that for sufficiently large $\kappa$, it preserves $\kappa$-filtered colimits in each fiber category, with $\kappa$ independent of the fiber.
This is the case for a dependent polynomial functor~\eqref{eq:depeq}, since the rank $\kappa$ depends only on the size of the fibers of $\Psi\fib \Theta$, which do not increase under pullback.

\begin{lem}\label{thm:monads}
  For every $n$, the following hold.
  \begin{enumerate}
  \item The $(\sC/\Gamma)$-indexed category $\cAlg_{n}$ is fiberwise cocomplete and fiberwise locally presentable.\label{item:im1}
  \item The pullback functors of $\cAlg_{n}$ have right adjoints, which commute with the forgetful functors $U_n:\cAlg_{n} \to \sC/\Delta$.\label{item:im2}
  \item The forgetful functor $\cAlg_{n+1}\to \cAlg_{n}$ is indexed-monadic with an indexed-accessible monad.\label{item:im3}
  \end{enumerate}
\end{lem}
\begin{proof}
  Beginning with $\cAlg_{0} = \sC/\Delta$, the first two statements hold since \sC is locally presentable and locally cartesian closed.
  Thus, suppose inductively that they hold for $\cAlg_{n}$.
  We will show~\ref{item:im3}, and then deduce~\ref{item:im1} and~\ref{item:im2}.

  If the $(n+1)^{\mathrm{st}}$ constructor is a 0-constructor specified by $\Theta$, $F$, and $s$ as in \S\ref{sec:hits}, then consider the indexed-accessible functor $s_! F : \cAlg_{n} \to \sC/\Delta$.
  By~\ref{item:im3} inductively, the forgetful functor $U_n:\cAlg_{n}\to \sC/\Delta$ has an indexed and indexed-accessible left adjoint, say $L_n$.
  Then $L_n s_! F$ is an indexed endofunctor of $\cAlg_{n}$, and an endofunctor-algebra for it is precisely an object of $\cAlg_{n}$ equipped with the structure~\eqref{eq:0constr-alg}, hence an object of $\cAlg_{n+1}$.

  In each fiber, let $T_{n+1}$ denote the algebraically-free monad generated by $L_n s_! F$, which exists since $L_n s_! F$ is accessible and $\cAlg_{n}$ is locally presentable.
  It is constructed using a transfinite colimit, and is accessible.
  Moreover, the construction of $T_{n+1}$ is preserved by pullback: pullback preserves colimits as $\cAlg_n$ is fiberwise cocomplete, and the length of the transfinite sequences depends only on the ranks $\kappa$, which are uniform in the parameters since $L_n s_! F$ is indexed-accessible.
  Thus $T_{n+1}$ is an indexed-accessible indexed monad, and its monad-algebras are the same as endofunctor-algebras for $L_n s_! F$.
  This shows~\ref{item:im3} in the case when the $(n+1)^{\mathrm{st}}$ constructor is a 0-constructor.

  Now suppose instead the $(n+1)^{\mathrm{st}}$ constructor is a 1-constructor, specified by $\Theta$, $F$, $s$, $t$, $H$, $u$, and $v$ as in \S\ref{sec:hits}.
  Let $L_n$ be the left adjoint of $U_n$, as above; then by adjunction $u$ and $v$ correspond to natural transformations $L_n s_! F \to \nId_{\cAlg_n}$ and $L_n t_! F \to \nId_{\cAlg_n}$.

  For any $X\in\cAlg_n$, the composites $F X \to \Theta \xto{s} \Delta$ and $F X \to \Theta \xto{t} \Delta$ and the homotopy $H:s\sim t$ yield a morphism $F X \otimes \ivl \to \Delta$.
  Together these form an indexed-accessible functor $F\otimes \ivl:\cAlg_n \to \sC/\Delta$, which comes with two natural transformations from $s_! F$ and $t_! F$ respectively.
  Moreover, to extend $X\in\cAlg_n$ to an object of $\cAlg_{n+1}$ is equivalent to giving an extension of $[u_X,v_X]:s_!FX + t_! FX \to X$ along the map $s_!FX + t_! FX  \to FX\otimes \ivl$.

  We have a diagram as shown on the left below in the category of indexed-accessible endofunctors of $\cAlg_n$.
  \begin{equation}
  \vcenter{\xymatrix@C=2pc{
      L_n s_! F + L_n t_! F\ar[r]^-{[u,v]}\ar[d] &
      \nId_{\cAlg_n}\\
      L_n (F\otimes \ivl)
    }}
  \hspace{2cm}
\vcenter{\xymatrix@C=2pc{
      \overline{L_n s_! F + L_n t_! F}\ar[r]^-{[u,v]}\ar[d] &
      \nId_{\cAlg_n}\\
      \overline{L_n (F\otimes \ivl)}
      }}
  \end{equation}
  Since $\nId_{\cAlg_n}$ is a monad, if we generate algebraically-free monads from the endofunctors on the left, we have an induced diagram as above on the right, in the category of indexed-accessible monads on $\cAlg_n$.
  Let $T_{n+1}$ be the algebraic monad-pushout.
  Since the free constructions and monad colimits are all performed by transfinite colimit constructions and all the functors are indexed-accessible, $T_{n+1}$ is an indexed monad.
  Moreover, a $T_{n+1}$-algebra is, by the universal property of algebraically-free monads and the adjunction $L_n \dashv U_n$, precisely an object of $\cAlg_{n+1}$.
  This shows~\ref{item:im3} when the $(n+1)^{\mathrm{st}}$ constructor is a 1-constructor; we now move on to~\ref{item:im1} and~\ref{item:im2}.

  The category of algebras for an accessible monad on a locally presentable category is always locally presentable.
  Its colimits are constructed using a transfinite iteration of the monad and colimits in the base category.
  Thus, since these are all preserved by pullback and $T_{n+1}$ is an indexed monad, it follows that $\cAlg_{n+1}$ is fiberwise cocomplete and fiberwise locally presentable, i.e.~\ref{item:im1} holds.

  Finally, since each pullback functor of $\cAlg_n$ is a strong monad morphism relative to the fiberwise parts of $T_{n+1}$, it follows by doctrinal adjunction that their right adjoints (which exist by hypothesis) are lax monad morphisms.
  Hence, they induce functors between the categories of algebras (namely, the fibers of $\cAlg_{n+1}$), which are right adjoint to the pullback functors.
  This shows~\ref{item:im2}.
\end{proof}

% \begin{rmk}
%   It is perhaps worth remarking on how this proof shows that even though the 0-constructors do not refer explicitly to the 1-constructors, the presence of the 1-constructors may require more ``0-constructor data'' to be put in anyway.
%   Namely, we build the monad for $\cAlg_{n+1}$ using transfinite colimit constructions \emph{in the category} $\cAlg_n$.
% \end{rmk}

In particular, the forgetful functor $U_n:\cAlg_n \to \sC/\Delta$ is a composite of monadic functors.
The composite of monadic functors may not be monadic, and we do not know whether these are in general.
However, in the case when the arguments of each constructor are independent of the other constructors, it is true.

\begin{lem}\label{thm:indargmonadic}
  If each $F:\cAlg_n \to \sC/\Delta$ factors through $U_n:\cAlg_n \to \sC/\Delta$ via an indexed-accessible functor $F':\sC/\Delta \to \sC/\Delta$, then each $U_n$ is indexed-monadic.
\end{lem}
\begin{proof}
  Assume by induction that $U_n$ is monadic, with monad $\That_n$ on $\sC/\Delta$.
  Suppose first that the $(n+1)^{\mathrm{st}}$ constructor is a 0-constructor.
  Then since $F = F' U_n$, an object of $\cAlg_{n+1}$ is just an object of $\cAlg_n$ (that is, a $\That_n$-monad-algebra) which also has an $F'$-endofunctor-algebra structure.
  Thus, if we let $\overline{F'}$ be the algebraically-free monad on $F'$, then we can take $\That_{n+1}$ to be the algebraic monad-coproduct of $\That_n$ and $\overline{F'}$.

  In the 1-constructor case, we have two transformations $u,v: F = F' U_n \toto U_n$.
  But by the mate correspondence, these are equivalent to a pair of transformations $F' \toto U_n L_n = \That_n$.
  Now an object of $\cAlg_{n+1}$ consists of an object of $\cAlg_n$ (that is, a $\That_n$-monad-algebra) together with a homotopy between the two composites
  \[ \xymatrix{ F' X  \ar@<1mm>[r]^-{u} \ar@<-1mm>[r]_-{v} & \That_n X \ar[r] & X }\]
  which restricts to $H$ in $\Delta$.
  Similarly to before, the homotopy $H$ makes $F'\otimes\ivl$ into an endofunctor of $\sC/\Delta$, and we have the left-hand diagram below in the category of endofunctors on $\sC/\Delta$.
  \begin{equation}
  \vcenter{\xymatrix{
      F' + F'\ar[r]\ar[d] &
      \That_n\\
      F'\otimes\ivl
    }}
  \hspace{2cm}
  \vcenter{\xymatrix{
      \overline{F' + F'}\ar[r]\ar[d] &
      \That_n\\
      \overline{F'\otimes\ivl}.
      }}
  \end{equation}
  Thus, we can let $\That_{n+1}$ be the algebraic monad-pushout of the right-hand diagram above in the category of monads on $\sC/\Delta$.
\end{proof}

Of course, we would now like to take our higher inductive type (with $n$ constructors) to be the initial object of $\cAlg_n$.
However, this object may not be a fibration over $\Delta$.
Thus, we need to fibrantly replace it in a controlled way.

Henceforth, we drop our abuse of notation that all categories are implicitly $(\sC/\Gamma)$-indexed.
Thus, $\cAlg_n$ now denotes what was previously the fiber of $\cAlg_n$ over $1_\Gamma$, and so on.

Let \sJ be the set of generating acyclic cofibrations in $\sC/\Delta$ (this is the set of all morphisms in $\sC/\Delta$ whose underlying morphism in \sC is a generating acyclic cofibration there).
By Garner's small object argument, there is a monad $R$ on $\sC/\Delta$ such that every fibrant object (that is, every fibration over $\Delta$) admits an $R$-algebra structure.

In fact, an $R$-algebra structure is precisely a choice of all possible lifts against maps in \sJ.
More generally, there is a codomain-preserving monad $\lR$ on the arrow category of $\sC/\Delta$, whose algebras are morphisms equipped with a choice of all possible lifts against \sJ.
Let $\cAlg_{n}^R$ denote the (unindexed) category of $I_n$-algebras equipped with an $R$-algebra structure on their underlying object in $\sC/\Delta$, and morphisms of $I_n$-algebras that are also $R$-algebra morphisms.

\begin{lem}
  The forgetful functor $\cAlg_{n}^R \to \cAlg_n$ is (unindexed) monadic, and in particular has a left adjoint $R_n$.
\end{lem}
\begin{proof}
  Consider the set of maps $L_n(\sJ)$ in $\cAlg_n$.
  Since $\cAlg_n$ is locally presentable, Garner's argument applies to this set of maps to construct a similar monad $R_n$ on $\cAlg_n$.
  Moreover, by adjunction, an $R_n$-algebra structure on $X$ is just an $R$-algebra structure on $U_n X$.
\end{proof}

We note that in the special case of \autoref{thm:indargmonadic}, $\cAlg_{n}^R$ is also monadic over $\sC/\Delta$.
The monad is simply the algebraic monad-coproduct of $\That_n$ and $R$.

Finally, we can define $W$ to be the initial object of $\cAlg_{n}^R$.
By construction, $W$ is clearly a fibration over $\Delta$ with the structure of an object of $\cAlg_n$.
Thus, it remains to show the dependent elimination property.

\begin{lem}\label{thm:elim1}
  Any morphism $B\fib W$ in $\cAlg_n$ which is a fibration in \sC has a section in $\cAlg_n$.
\end{lem}
\begin{proof}
  Since $B\fib W$ is a fibration, we can give it an \lR-algebra structure.
  But $W$ also has a given $R$-algebra structure, which is to say that $W\to 1$ has an \lR-algebra structure.
  Garner has shown that \lR-algebras have a natural composition law: if $f$ and $g$ are \lR-algebras, then $gf$ has a canonical \lR-algebra structure such that the commutative square
  \begin{equation}
  \vcenter{\xymatrix@-.5pc{
      \ar[r]^f\ar[d]_{gf} &
      \ar[d]^g\\
      \ar@{=}[r] &
      }}
  \end{equation}
  is a morphism of \lR-algebras.
  Therefore, the object $B$ has an $R$-algebra structure such that the morphism $B\fib W$ becomes a morphism of $R$-algebras.
  Since it is by assumption a morphism of $\cAlg_n$, this means that it becomes a morphism of $\cAlg_n^R$.
  But $W$ is the initial object of $\cAlg_n^R$, so any morphism in $\cAlg_n^R$ with codomain $W$ must have a section.
  This section is, of course, also a section in $\cAlg_n$.
\end{proof}

What's left of \autoref{def:hit}\ref{item:hit3} is the weak stability of this universal property under pullback along maps into \Gamma.
If $R$ were an indexed monad, we would be done, but unfortunately it is not.
Fortunately, however, \autoref{thm:hit3fib} implies that it is sufficient to consider weak stability under pullback along \emph{fibrations}, and in this case we can use dependent products to solve our problem.

For a morphism $f:\Phi \to\Gm$, regarded as an object of $\sC/\Gamma$, we will write $\cAlg_n^\Phi$ for the corresponding fiber category of the indexed category $\cAlg_n$, leaving the structure morphism $f$ implicit.

\begin{lem}\label{thm:elim2}
  If $f:\Phi \fib\Gm$ is a fibration, then any morphism $B\fib f^* W$ in $\cAlg_n^\Phi$ which is a fibration in \sC has a section in $\cAlg_n^\Phi$.
\end{lem}
\begin{proof}
  By \autoref{thm:monads}, $f^*$ has a right adjoint which lifts to $\cAlg_n$; denote it by $f_*$.
  Moreover, since $f_*$ acts on underlying objects by dependent product in \sC, and $f$ is a fibration, $f_*$ preserves fibrations.
  Therefore, $f_* B \fib f_* f^* W$ is a fibration which is also a morphism in $\cAlg_n^\Gm$.
  Pulling it back along the unit map $W \to f_* f^* W$, we obtain the hypotheses of \autoref{thm:elim1}, and hence a lift of the unit to a map $W \to f_* B$ in $\cAlg_n^\Gm$.
  By adjointness, this yields a section of $B\fib f^* W$ in $\cAlg_n^\Phi$.
\end{proof}

This completes the proof of the following.

\begin{thm}\label{thm:lp-hit}
  Let \sC be a locally presentable, locally cartesian closed, right proper, cofibrantly generated, simplicial model category whose cofibrations are the monomorphisms.
  Let $I$ be a specification for a higher inductive type in \sC, for which each functor $F$ preserves fibrations and is indexed-accessible (such as if they are dependent polynomials~\eqref{eq:deppoly}).
  Then the corresponding higher inductive type exists.\qed
\end{thm}

As remarked previously, any $(\infty,1)$-topos can be presented by a model category satisfying the above assumptions.
It is an open problem whether such a model category can always be found which also includes strict universe objects satisfying the univalence axiom.
This is known to be possible for certain restricted classes of $(\infty,1)$-topoi, notably $\infty\mathrm{Gpd}$ (the simplicial set model of Voevodsky) and presheaves of such on direct categories and elegant Reedy categories (Shulman).

Moreover, any model category that presents an $(\infty,1)$-topos does include univalent ``weak universe objects'', arising simply from fibrant presentations of the object classifiers of the underlying $(\infty,1)$-topos.
In the type theory, these weak universes give rise to universes of ``codes for types'' which are ``weakly a la Tarski'', in the sense that the coercion from codes to types respects the type-forming operations only up to equivalence.
However, this should be sufficient for most purposes related to higher inductive definitions, where what we usually need is ``large eliminations'' out of a higher inductive type into a univalent universe.


% \begin{thm}
%   If $f:\Phi \to\Gm$ is any morphism with $\Phi$ fibrant, then any morphism $B\fib f^* W$ in $\cAlg_n^\Phi$ which is a fibration in \sC has a section in $\cAlg_n^\Phi$.
% \end{thm}
% \begin{proof}
%   Factor $f$ as an acyclic cofibration followed by a fibration, $\Phi \xto{w} \Upsilon \xto{g} \Gm$.
%   Since $\Phi$ and $\Upsilon$ are fibrant, $w$ is the inclusion of a deformation retract, i.e.\ there is a map $r:\Upsilon \to \Phi$ such that $r w = 1_\Phi$ and a homotopy $w r \sim 1_\Upsilon$ which restricts along $w$ to the identity.

%   By standard lifting arguments in a simplicial model category, we can use the homotopy $f r = g w r \sim g$ to build a map $g^*W \to r^* f^* W$ over $\Upsilon$ which pulls back along $w$ to the identity.
%   \emph{HOLE: Can we make it an $n$-algebra map??}

%   Now by \autoref{thm:elim2} applied to the fibration $g$, we obtain a lifting
%   \begin{equation}
%     \vcenter{\xymatrix{
%       & r^* B\ar@{->>}[d]\\
%       g^* W\ar[r] \ar[ur] &
%       r^* f^* W
%       }}
%   \end{equation}
%   in $\cAlg_n^{\Upsilon}$.
%   Pulling this back along $w$, we obtain
%   \begin{equation}
%     \vcenter{\xymatrix{
%       & w^* r^* B \mathrlap{\;\cong B}\ar@{->>}[d]\\
%       \mathllap{f^* W\cong\;} w^* g^* W\ar[r] \ar[ur] &
%       w^* r^* f^* W \mathrlap{\;\cong f^*W}
%       }}
%   \end{equation}
%   in $\cAlg_n^{\Phi}$.
%   By construction, the bottom composite $f^* W\to f^* W$ is the identity, so this is our desired section.
% \end{proof}

% TODO: More examples, HIITS
% - Cauchy reals
% - surreal numbers
% - Type theory should eat itself


\end{document}
